// Generated by CoffeeScript 1.3.3
(function() {
  var $, authomatic, popup;

  $ = jQuery;

  popup = function(url, width, height) {
    var left, settings, top;
    top = (screen.height / 2) - (height / 2);
    left = (screen.width / 2) - (width / 2);
    settings = "width=" + width + ",height=" + height + ",top=" + top + ",left=" + left;
    return window.open(url, "authomatic:" + url, settings);
  };

  authomatic = function() {};

  authomatic.popup = function(width, height, validator, aSelector, formSelector) {
    if (width == null) {
      width = 800;
    }
    if (height == null) {
      height = 600;
    }
    if (validator == null) {
      validator = (function($form) {
        return true;
      });
    }
    if (aSelector == null) {
      aSelector = 'a.authomatic';
    }
    if (formSelector == null) {
      formSelector = 'form.authomatic';
    }
    $(aSelector).click(function(e) {
      e.preventDefault();
      return popup(this.href, width, height);
    });
    return $(formSelector).submit(function(e) {
      var $form, url;
      e.preventDefault();
      $form = $(this);
      url = $form.attr('action') + '?' + $form.serialize();
      if (validator($form)) {
        return popup(url, width, height);
      }
    });
  };

  $.fn.authomatic = authomatic;

}).call(this);
