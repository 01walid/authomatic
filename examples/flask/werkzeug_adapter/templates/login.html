{% extends "base.html" %}

{% block body %}

	<a href="/">Home</a>
	
	{% if result.error %}
		<h2>Damn that error: {{ result.error.message }}</h2>
	{% endif %}
	
	{% if result.user %}
		<h1>Hi {{ result.user.name }}</h1>
		<h2>Your id is: {{ result.user.id }}</h2>
		<h2>Your email is: {{ result.user.email }}</h2>
	{% endif %}
	
	{% if result.user.credentials %}
	
		{% if result.provider.name == 'fb' %}
			Your are logged in with Facebook.<br />
			
			{% set url = 'https://graph.facebook.com/{}?fields=feed.limit(5)'.format(result.user.id) %}
			{% set response = result.provider.access(url) %}
			
			{% if response.status == 200 %}
				
				{% if response.data.error %}
					Damn that error: {{ response.data.error }}!
				{% endif %}
				
				{% if response.data.feed.data %}
					Your 5 most recent statuses:<br />
					
					{% for status in response.data.feed.data %}
						<h3>{{ status.message or status.name or status.story }}</h3>
						Posted on: {{ status.created_time }}
					{% endfor %}
				{% endif %}
				
			{% endif %}
			
		{% endif %}
		
		{% if result.provider.name == 'tw' %}
			Your are logged in with Twitter.<br />
			
			{% set url = 'https://api.twitter.com/1.1/statuses/user_timeline.json?count=5' %}
			{% set response = result.provider.access(url) %}
			
			{% if response.status == 200 %}
				
				{% if response.data.errors %}
					Damn that error: {{ response.data.errors }}!
				{% endif %}
				
				{% if response.data %}
					Your 5 most recent tweets:<br />
					
					{% for tweet in response.data %}
						<h3>{{ tweet.text }}</h3>
						Posted on: {{ tweet.created_at }}
					{% endfor %}
				{% endif %}
				
			{% endif %}
			
		{% endif %}
	{% endif %}

{% endblock %}
